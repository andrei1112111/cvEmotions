# cvEmotions

Наивная система распознавания эмоций на основе opencv. Что значит наивная? Если улыбка найдена — 'радость' Если глаза закрыты — 'усталость' Иначе - 'нейтрально'.

## Требования

- Python 3.x

Установка зависимостей

```
pip install -r requirements.txt
```

## Использование

```
python detect_emotion.py -i happy_man.jpg
```

```
радость
```

## Бенчмарк

```
python banchmark.py
```

```
Загрузка датасета...
Загружено 13233 лиц
100%|████████████████████████████████████████████████████████████████████████████████████| 13233/13233 [06:48<00:00, 32.38it/s]
Найдено 708 лиц с эмоциями
Первые 6:
```

<p>
<img width="800" src="banchmark/1.png" alt="qr"/>
</p>

\*лица с эмоциями - лица с 'радость' или 'усталось'

## Использованные компоненты

При разработке системы распознавания эмоций по лицу использованы отдельные модули из ранее выполненных проектов:

1. [Detector-smile-CV-02-27](https://github.com/NatashaBedareva/Detector-smile-CV-02-27) — модуль детектирования улыбки с использованием каскада Хаара (haarcascade_smile.xml).

Использованные файлы:

- `detect_faces.py`
- `detect_smile.py`

Использован для определения признака «улыбка» и классификации эмоции радость.

2. [CV-2-33-detect-eye-whites](https://github.com/noki1928/CV-2-33-detect-eye-whites) — модуль детектирования глаз и анализа белков глаз.

Использованные файлы:

- `detect_eyes_whites.py`

Использован для определения признака «закрытые глаза» и классификации эмоции усталость.

## Структура проекта

```
cvEmotions/
├── detect_emotion.py      # скрипт распознающий эмоции
├── banchmark.py           # тестирование на датасете lfw_people
├── detectors/
│ ├── detect_eye_whites.py # заимствовано из CV-2-33
│ ├── detect_smile.py      # заимствовано из CV-2-27
│ └── detect_faces.py      # заимствовано из CV-2-27
└── README.md

```
